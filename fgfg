-- Delta –∞–≤—Ç–æ-—Å–ø–∞–º —Å–∫—Ä–∏–ø—Ç –¥–ª—è MM2 —Å Server Hop
local Players = game:GetService("Players")
local TeleportService = game:GetService("TeleportService")
local HttpService = game:GetService("HttpService")
local player = Players.LocalPlayer
local placeId = game.PlaceId

-- –ü—Ä–æ–≤–µ—Ä—è–µ–º —á—Ç–æ –º—ã –≤ MM2
if placeId ~= 142823291 then
    warn("‚ùå –≠—Ç–æ –Ω–µ MM2! –ó–∞–ø—É—Å—Ç–∏—Ç–µ —Å–∫—Ä–∏–ø—Ç –≤ Murder Mystery 2")
    return
end

-- –§–ª–∞–≥ –¥–ª—è –∞–≤—Ç–æ–∑–∞–ø—É—Å–∫–∞ –≤ Delta
getgenv().AutoSpamEnabled = true

local messages = {
    "üíé –ü—Ä–æ–¥–∞–º Godly –¥–µ—à–µ–≤–æ –∑–∞ –≥—Ä–Ω. Hexon_Shop",
    "üî• Godly –∑–∞ –≥—Ä–∏–≤–Ω—ã. –ë—ã—Å—Ç—Ä–æ. Hexon_Shop",
    "üí∞ –ö—É–ø–∏—Ç—å Godly –Ω–µ–¥–æ—Ä–æ–≥–æ. Hexon_Shop",
    "üéÆ Godly –ø–æ –≤—ã–≥–æ–¥–Ω–æ–π —Ü–µ–Ω–µ. Hexon_Shop",
    "‚≠ê Godly –¥–ª—è —Ç—Ä–µ–π–¥–∞. Hexon_Shop",
    "‚ö° –î–µ—à–µ–≤—ã–π Godly –∑–∞ –≥—Ä–Ω. Hexon_Shop",
    "üîî –ü—Ä–æ–¥–∞–∂–∞ Godly. Hexon_Shop",
    "‚ú® Godly –≤ –Ω–∞–ª–∏—á–∏–∏. Hexon_Shop",
    "üöÄ –ü–æ–∫—É–ø–∞–π Godly. Hexon_Shop",
    "üíØ Godly –ø–æ –Ω–∏–∑–∫–æ–π —Ü–µ–Ω–µ. Hexon_Shop"
}

-- –§—É–Ω–∫—Ü–∏—è –¥–ª—è –ø–µ—Ä–µ–º–µ—à–∏–≤–∞–Ω–∏—è
local function shuffle(tbl)
    for i = #tbl, 2, -1 do
        local j = math.random(i)
        tbl[i], tbl[j] = tbl[j], tbl[i]
    end
    return tbl
end

-- –û—Ç–ø—Ä–∞–≤–∫–∞ —Å–æ–æ–±—â–µ–Ω–∏—è
local function sendMessage(text)
    local success1 = pcall(function()
        game:GetService("ReplicatedStorage").DefaultChatSystemChatEvents.SayMessageRequest:FireServer(text, "All")
    end)
    
    local success2 = pcall(function()
        game:GetService("TextChatService").TextChannels.RBXGeneral:SendAsync(text)
    end)
    
    return success1 or success2
end

-- –§—É–Ω–∫—Ü–∏—è –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è —Å–ø–∏—Å–∫–∞ —Å–µ—Ä–≤–µ—Ä–æ–≤ (Server Hop)
local function getServers()
    local servers = {}
    local cursor = ""
    
    for _ = 1, 3 do -- –ü–æ–ª—É—á–∞–µ–º –Ω–µ—Å–∫–æ–ª—å–∫–æ —Å—Ç—Ä–∞–Ω–∏—Ü
        local url = string.format(
            "https://games.roblox.com/v1/games/%s/servers/Public?sortOrder=Asc&limit=100%s",
            placeId,
            cursor ~= "" and "&cursor=" .. cursor or ""
        )
        
        local success, response = pcall(function()
            return game:HttpGetAsync(url)
        end)
        
        if success then
            local data = HttpService:JSONDecode(response)
            
            if data and data.data then
                for _, server in ipairs(data.data) do
                    -- –ò—Å–∫–ª—é—á–∞–µ–º —Ç–µ–∫—É—â–∏–π —Å–µ—Ä–≤–µ—Ä –∏ —Å–ª–∏—à–∫–æ–º –∑–∞–ø–æ–ª–Ω–µ–Ω–Ω—ã–µ
                    if server.id ~= game.JobId and server.playing < server.maxPlayers - 2 then
                        table.insert(servers, {
                            id = server.id,
                            players = server.playing,
                            max = server.maxPlayers
                        })
                    end
                end
                
                cursor = data.nextPageCursor
                if not cursor or cursor == "" then
                    break
                end
            end
        else
            break
        end
    end
    
    -- –°–æ—Ä—Ç–∏—Ä—É–µ–º –ø–æ –∫–æ–ª–∏—á–µ—Å—Ç–≤—É –∏–≥—Ä–æ–∫–æ–≤ (–º–µ–Ω—å—à–µ –∏–≥—Ä–æ–∫–æ–≤ = –ª—É—á—à–µ)
    table.sort(servers, function(a, b)
        return a.players < b.players
    end)
    
    return servers
end

-- –§—É–Ω–∫—Ü–∏—è Server Hop (–ø–µ—Ä–µ—Ö–æ–¥ –Ω–∞ –¥—Ä—É–≥–æ–π —Å–µ—Ä–≤–µ—Ä)
local function serverHop()
    print("üîÑ –ü–æ–∏—Å–∫ –Ω–æ–≤–æ–≥–æ —Å–µ—Ä–≤–µ—Ä–∞...")
    
    local servers = getServers()
    
    if #servers > 0 then
        -- –í—ã–±–∏—Ä–∞–µ–º —Å–µ—Ä–≤–µ—Ä —Å –Ω–∞–∏–º–µ–Ω—å—à–∏–º –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ–º –∏–≥—Ä–æ–∫–æ–≤
        local bestServer = servers[1]
        
        print(string.format("üéØ –ù–∞–π–¥–µ–Ω —Å–µ—Ä–≤–µ—Ä: %s (–∏–≥—Ä–æ–∫–æ–≤: %d/%d)", 
            string.sub(bestServer.id, 1, 8) .. "...", 
            bestServer.players, 
            bestServer.max))
        
        -- –ü—ã—Ç–∞–µ–º—Å—è –ø–µ—Ä–µ–π—Ç–∏ –Ω–∞ –Ω–∞–π–¥–µ–Ω–Ω—ã–π —Å–µ—Ä–≤–µ—Ä
        local success, errorMsg = pcall(function()
            TeleportService:TeleportToPlaceInstance(placeId, bestServer.id, player)
        end)
        
        if success then
            print("‚úÖ –£—Å–ø–µ—à–Ω—ã–π –ø–µ—Ä–µ—Ö–æ–¥ –Ω–∞ –Ω–æ–≤—ã–π —Å–µ—Ä–≤–µ—Ä!")
            return true
        else
            print("‚ö†Ô∏è –û—à–∏–±–∫–∞ –ø–µ—Ä–µ—Ö–æ–¥–∞: " .. tostring(errorMsg))
        end
    else
        print("‚ö†Ô∏è –ù–µ –Ω–∞–π–¥–µ–Ω–æ –ø–æ–¥—Ö–æ–¥—è—â–∏—Ö —Å–µ—Ä–≤–µ—Ä–æ–≤")
    end
    
    -- –ï—Å–ª–∏ –Ω–µ —É–¥–∞–ª–æ—Å—å, –ø—Ä–æ–±—É–µ–º –æ–±—ã—á–Ω—ã–π Teleport
    print("üîÑ –ü—Ä–æ–±—É—é –æ–±—ã—á–Ω—ã–π –ø–µ—Ä–µ—Ö–æ–¥...")
    local success2 = pcall(function()
        TeleportService:Teleport(placeId)
    end)
    
    return success2
end

-- –û–∂–∏–¥–∞–Ω–∏–µ –∑–∞–≥—Ä—É–∑–∫–∏ –∏–≥—Ä—ã –ø–æ—Å–ª–µ —Ç–µ–ª–µ–ø–æ—Ä—Ç–∞—Ü–∏–∏
local function waitForGameLoad()
    local maxWait = 15
    local waited = 0
    
    print("‚è≥ –û–∂–∏–¥–∞–Ω–∏–µ –∑–∞–≥—Ä—É–∑–∫–∏ –∏–≥—Ä—ã...")
    
    while waited < maxWait do
        if game:IsLoaded() and player.Character then
            print("‚úÖ –ò–≥—Ä–∞ –∑–∞–≥—Ä—É–∂–µ–Ω–∞")
            return true
        end
        waited = waited + 1
        task.wait(1)
    end
    
    print("‚ö†Ô∏è –¢–∞–π–º–∞—É—Ç –∑–∞–≥—Ä—É–∑–∫–∏ –∏–≥—Ä—ã")
    return false
end

-- –û—Å–Ω–æ–≤–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è
local function startAutoSpam()
    print("ü§ñ Delta –∞–≤—Ç–æ-—Å–ø–∞–º —Å Server Hop –∞–∫—Ç–∏–≤–∏—Ä–æ–≤–∞–Ω!")
    print("üì¢ –°–æ–æ–±—â–µ–Ω–∏—è: Godly –∑–∞ –≥—Ä–∏–≤–Ω—ã | Hexon_Shop")
    
    while getgenv().AutoSpamEnabled do
        -- –ñ–¥–µ–º –ø–æ–ª–Ω–æ–π –∑–∞–≥—Ä—É–∑–∫–∏ –∏–≥—Ä—ã
        if not waitForGameLoad() then
            task.wait(5)
            continue
        end
        
        -- –ñ–¥–µ–º –∑–∞–≥—Ä—É–∑–∫–∏ —á–∞—Ç–∞
        local chatLoaded = false
        for i = 1, 8 do
            if pcall(function() 
                return game:GetService("ReplicatedStorage"):FindFirstChild("DefaultChatSystemChatEvents") 
            end) then
                chatLoaded = true
                break
            end
            task.wait(1)
        end
        
        if not chatLoaded then
            print("‚ö†Ô∏è –ß–∞—Ç –Ω–µ –∑–∞–≥—Ä—É–∑–∏–ª—Å—è, –ø—Ä–æ–±—É—é Server Hop...")
            serverHop()
            task.wait(10)
            continue
        end
        
        print("‚úÖ –ß–∞—Ç –≥–æ—Ç–æ–≤, –Ω–∞—á–∏–Ω–∞—é –æ—Ç–ø—Ä–∞–≤–∫—É...")
        
        -- –û—Ç–ø—Ä–∞–≤–ª—è–µ–º 5 —Å–æ–æ–±—â–µ–Ω–∏–π
        local shuffled = shuffle(messages)
        local sentCount = 0
        
        for i = 1, 5 do
            if not getgenv().AutoSpamEnabled then break end
            
            local sent = sendMessage(shuffled[i])
            if sent then
                sentCount = sentCount + 1
                print(string.format("‚úÖ [%d/5] –û—Ç–ø—Ä–∞–≤–ª–µ–Ω–æ", sentCount))
            else
                print("‚ö†Ô∏è –ù–µ —É–¥–∞–ª–æ—Å—å –æ—Ç–ø—Ä–∞–≤–∏—Ç—å —Å–æ–æ–±—â–µ–Ω–∏–µ")
            end
            
            if i < 5 then -- –ù–µ –∂–¥–µ–º –ø–æ—Å–ª–µ –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ —Å–æ–æ–±—â–µ–Ω–∏—è
                task.wait(math.random(3, 4))
            end
        end
        
        -- Server Hop –ø–æ—Å–ª–µ —Å–æ–æ–±—â–µ–Ω–∏–π
        if getgenv().AutoSpamEnabled and sentCount > 0 then
            print("üîÑ Server Hop –ø–æ—Å–ª–µ " .. sentCount .. " —Å–æ–æ–±—â–µ–Ω–∏–π...")
            task.wait(2) -- –ö–æ—Ä–æ—Ç–∫–∞—è –ø–∞—É–∑–∞
            
            local hopSuccess = serverHop()
            
            if hopSuccess then
                -- –ñ–¥–µ–º —Ç–µ–ª–µ–ø–æ—Ä—Ç–∞—Ü–∏—é
                task.wait(8)
            else
                -- –ï—Å–ª–∏ –Ω–µ —É–¥–∞–ª–æ—Å—å, –∂–¥–µ–º –∏ –ø—Ä–æ–±—É–µ–º —Å–Ω–æ–≤–∞
                task.wait(10)
            end
        else
            -- –ï—Å–ª–∏ –Ω–µ –æ—Ç–ø—Ä–∞–≤–∏–ª–∏ –Ω–∏ –æ–¥–Ω–æ–≥–æ —Å–æ–æ–±—â–µ–Ω–∏—è, –∂–¥–µ–º –∏ –ø—Ä–æ–±—É–µ–º Server Hop
            task.wait(5)
            if getgenv().AutoSpamEnabled then
                serverHop()
                task.wait(8)
            end
        end
    end
    
    print("‚èπÔ∏è –ê–≤—Ç–æ-—Å–ø–∞–º –æ—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω")
end

-- –§—É–Ω–∫—Ü–∏—è –æ—Å—Ç–∞–Ω–æ–≤–∫–∏
local function stopAutoSpam()
    getgenv().AutoSpamEnabled = false
    print("‚èπÔ∏è –ê–≤—Ç–æ-—Å–ø–∞–º –æ—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω")
end

-- UI –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
local function createControlUI()
    if not getgenv().CreatedUI then
        getgenv().CreatedUI = true
        
        local ScreenGui = Instance.new("ScreenGui")
        ScreenGui.Name = "DeltaSpamControl"
        ScreenGui.Parent = game.CoreGui
        
        local Frame = Instance.new("Frame")
        Frame.Size = UDim2.new(0, 220, 0, 140)
        Frame.Position = UDim2.new(0, 10, 0, 10)
        Frame.BackgroundColor3 = Color3.fromRGB(30, 30, 40)
        Frame.Parent = ScreenGui
        
        local Title = Instance.new("TextLabel")
        Title.Size = UDim2.new(1, 0, 0, 30)
        Title.Text = "DELTA MM2 SPAM"
        Title.TextColor3 = Color3.fromRGB(0, 200, 255)
        Title.BackgroundColor3 = Color3.fromRGB(20, 20, 30)
        Title.Parent = Frame
        
        local Status = Instance.new("TextLabel")
        Status.Size = UDim2.new(1, 0, 0, 25)
        Status.Position = UDim2.new(0, 0, 0, 35)
        Status.Text = "Status: READY"
        Status.TextColor3 = Color3.fromRGB(0, 255, 0)
        Status.Parent = Frame
        
        local StartBtn = Instance.new("TextButton")
        StartBtn.Size = UDim2.new(0.9, 0, 0, 30)
        StartBtn.Position = UDim2.new(0.05, 0, 0.45, 0)
        StartBtn.Text = "‚ñ∂Ô∏è START SPAM"
        StartBtn.BackgroundColor3 = Color3.fromRGB(0, 150, 0)
        StartBtn.Parent = Frame
        
        local StopBtn = Instance.new("TextButton")
        StopBtn.Size = UDim2.new(0.9, 0, 0, 30)
        StopBtn.Position = UDim2.new(0.05, 0, 0.75, 0)
        StopBtn.Text = "‚èπÔ∏è STOP"
        StopBtn.BackgroundColor3 = Color3.fromRGB(150, 0, 0)
        StopBtn.Parent = Frame
        
        StartBtn.MouseButton1Click:Connect(function()
            if not getgenv().AutoSpamEnabled then
                getgenv().AutoSpamEnabled = true
                Status.Text = "Status: RUNNING"
                Status.TextColor3 = Color3.fromRGB(255, 255, 0)
                coroutine.wrap(startAutoSpam)()
            end
        end)
        
        StopBtn.MouseButton1Click:Connect(function()
            stopAutoSpam()
            Status.Text = "Status: STOPPED"
            Status.TextColor3 = Color3.fromRGB(255, 0, 0)
        end)
        
        print("üéÆ –ö–æ–Ω—Ç—Ä–æ–ª—å–Ω–∞—è –ø–∞–Ω–µ–ª—å —Å–æ–∑–¥–∞–Ω–∞!")
    end
end

-- –ê–≤—Ç–æ-—Å—Ç–∞—Ä—Ç
task.wait(3)
createControlUI()

-- –≠–∫—Å–ø–æ—Ä—Ç–∏—Ä—É–µ–º —Ñ—É–Ω–∫—Ü–∏–∏ –¥–ª—è —Ä—É—á–Ω–æ–≥–æ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è
getgenv().StartSpam = function()
    if not getgenv().AutoSpamEnabled then
        getgenv().AutoSpamEnabled = true
        print("üöÄ –ó–∞–ø—É—Å–∫ —Å–ø–∞–º–∞...")
        coroutine.wrap(startAutoSpam)()
    else
        print("‚ö†Ô∏è –°–ø–∞–º —É–∂–µ –∑–∞–ø—É—â–µ–Ω")
    end
end

getgenv().StopSpam = stopAutoSpam
getgenv().HopServer = serverHop -- –†—É—á–Ω–æ–π Server Hop

print("==========================================")
print("üéØ DELTA MM2 AUTO-SPAM WITH SERVER HOP")
print("üéØ Commands:")
print("üéØ   StartSpam() - –∑–∞–ø—É—Å—Ç–∏—Ç—å —Å–ø–∞–º")
print("üéØ   StopSpam() - –æ—Å—Ç–∞–Ω–æ–≤–∏—Ç—å —Å–ø–∞–º")
print("üéØ   HopServer() - —Å–º–µ–Ω–∏—Ç—å —Å–µ—Ä–≤–µ—Ä –≤—Ä—É—á–Ω—É—é")
print("üéØ   AutoSpamEnabled = false - –æ—Å—Ç–∞–Ω–æ–≤–∏—Ç—å")
print("==========================================")

-- –ê–≤—Ç–æ-–∑–∞–ø—É—Å–∫ –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ (–µ—Å–ª–∏ –Ω—É–∂–Ω–æ)
if getgenv().AutoStartOnLoad then
    task.wait(5)
    getgenv().StartSpam()
end
