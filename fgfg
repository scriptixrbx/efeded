local Players = game:GetService("Players")
local TeleportService = game:GetService("TeleportService")
local HttpService = game:GetService("HttpService")
local player = Players.LocalPlayer
local placeId = game.PlaceId

local messages = {
    "–ü—Ä–æ–¥–∞–º Godly –¥–µ—à–µ–≤–æ –∑–∞ –≥—Ä–Ω. –ü–∏—à–∏: Hexon_Shop",
    "Godly –∑–∞ –≥—Ä–∏–≤–Ω—ã. –ë—ã—Å—Ç—Ä–æ. Hexon_Shop",
    "–ö—É–ø–∏—Ç—å Godly –Ω–µ–¥–æ—Ä–æ–≥–æ. –û–ø–ª–∞—Ç–∞ –≥—Ä–Ω. Hexon_Shop",
    "–ï—Å—Ç—å Godly –ø–æ –≤—ã–≥–æ–¥–Ω–æ–π —Ü–µ–Ω–µ –≤ –≥—Ä–Ω. Hexon_Shop",
    "Godly –¥–ª—è —Ç—Ä–µ–π–¥–∞ –∑–∞ –≥—Ä–∏–≤–Ω—ã. Hexon_Shop",
    "–î–µ—à–µ–≤—ã–π Godly –∑–∞ –≥—Ä–Ω. –ü–∏—à–∏: Hexon_Shop",
    "–ü—Ä–æ–¥–∞–∂–∞ Godly. –û–ø–ª–∞—Ç–∞ –≤ –≥—Ä–∏–≤–Ω–∞—Ö. Hexon_Shop",
    "Godly –≤ –Ω–∞–ª–∏—á–∏–∏. –¶–µ–Ω–∞ –≤ –≥—Ä–Ω. Hexon_Shop",
    "–ü–æ–∫—É–ø–∞–π Godly –∑–∞ –≥—Ä–∏–≤–Ω—ã. Hexon_Shop",
    "Godly –ø–æ –Ω–∏–∑–∫–æ–π —Ü–µ–Ω–µ –≤ –≥—Ä–Ω. Hexon_Shop"
}

-- –°—Ç–∏–∫–µ—Ä—ã/—Å–º–∞–π–ª–∏–∫–∏ –¥–ª—è –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –≤ —Å–æ–æ–±—â–µ–Ω–∏—è
local stickers = {
    "üíé", "üî•", "üéÆ", "üí∞", "üó°Ô∏è", "‚≠ê", "üîπ", "üõí", "üéØ", "‚ö°",
    "‚ú®", "ü§ë", "üí∏", "üíØ", "‚úÖ", "üîÑ", "üöÄ", "üìà", "ü™ô", "üîî"
}

-- –§—É–Ω–∫—Ü–∏—è –¥–ª—è –ø–µ—Ä–µ–º–µ—à–∏–≤–∞–Ω–∏—è —Ç–∞–±–ª–∏—Ü—ã
local function shuffle(tbl)
    local copy = {}
    for i, v in ipairs(tbl) do
        copy[i] = v
    end
    for i = #copy, 2, -1 do
        local j = math.random(i)
        copy[i], copy[j] = copy[j], copy[i]
    end
    return copy
end

-- –§—É–Ω–∫—Ü–∏—è –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è —Å–ª—É—á–∞–π–Ω–æ–≥–æ —Å—Ç–∏–∫–µ—Ä–∞
local function getRandomSticker()
    return stickers[math.random(1, #stickers)]
end

-- –§—É–Ω–∫—Ü–∏—è –æ—Ç–ø—Ä–∞–≤–∫–∏ –≤ —á–∞—Ç —Å–æ —Å—Ç–∏–∫–µ—Ä–∞–º–∏
local function sendMessage(text)
    -- –î–æ–±–∞–≤–ª—è–µ–º —Å–ª—É—á–∞–π–Ω—ã–π —Å—Ç–∏–∫–µ—Ä –≤ –Ω–∞—á–∞–ª–æ –∏–ª–∏ –∫–æ–Ω–µ—Ü —Å–æ–æ–±—â–µ–Ω–∏—è
    local decoratedText = getRandomSticker() .. " " .. text .. " " .. getRandomSticker()
    
    pcall(function()
        game:GetService("ReplicatedStorage")
            .DefaultChatSystemChatEvents
            .SayMessageRequest
            :FireServer(decoratedText, "All")
    end)
    pcall(function()
        game:GetService("TextChatService")
            .TextChannels
            .RBXGeneral
            :SendAsync(decoratedText)
    end)
end

-- –§—É–Ω–∫—Ü–∏—è –ø–µ—Ä–µ—Ö–æ–¥–∞ –Ω–∞ –¥—Ä—É–≥–æ–π —Å–µ—Ä–≤–µ—Ä —Å –æ–±—Ä–∞–±–æ—Ç–∫–æ–π –∫—É—Ä—Å–æ—Ä–∞
local function hopServer()
    local servers = {}
    local req = request or http_request or syn.request
    local cursor = nil
    
    repeat
        local url = "https://games.roblox.com/v1/games/" .. placeId .. "/servers/Public?sortOrder=Asc&limit=100"
        if cursor then url = url .. "&cursor=" .. cursor end
        
        local response = req({Url = url, Method = "GET"})
        local body = HttpService:JSONDecode(response.Body)
        
        for _, v in pairs(body.data) do
            if v.playing < v.maxPlayers and v.id ~= game.JobId then
                table.insert(servers, v.id)
            end
        end
        cursor = body.nextPageCursor
    until not cursor
    
    if #servers > 0 then
        TeleportService:TeleportToPlaceInstance(placeId, servers[math.random(1, #servers)], player)
    else
        TeleportService:Teleport(placeId)
    end
end

-- –§—É–Ω–∫—Ü–∏—è –∞–≤—Ç–æ-–ø–µ—Ä–µ–∑–∞—Ö–æ–¥–∞ –ø—Ä–∏ –≤—ã—Ö–æ–¥–µ
local function setupAutoRejoin()
    -- –ü–µ—Ä–µ–∑–∞—Ö–æ–¥ –ø—Ä–∏ –∫–∏–∫–µ/–≤—ã–ª–µ—Ç–µ
    game:GetService("Players").LocalPlayer.OnTeleport:Connect(function(state)
        if state == Enum.TeleportState.Failed or state == Enum.TeleportState.Started then
            TeleportService:Teleport(placeId)
        end
    end)
    
    -- –ü–µ—Ä–µ–∑–∞—Ö–æ–¥ –ø—Ä–∏ –¥–∏—Å–∫–æ–Ω–Ω–µ–∫—Ç–µ
    game:GetService("NetworkClient").Disconnected:Connect(function()
        TeleportService:Teleport(placeId)
    end)
end

-- –û—Å–Ω–æ–≤–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è —Å –∑–∞—â–∏—Ç–æ–π –æ—Ç –æ—à–∏–±–æ–∫
local function mainLoop()
    while true do
        local success, errorMsg = pcall(function()
            local shuffled = shuffle(messages)
            
            -- –û—Ç–ø—Ä–∞–≤–ª—è–µ–º 5 —Å–æ–æ–±—â–µ–Ω–∏–π
            for i = 1, 5 do
                sendMessage(shuffled[i])
                task.wait(3) -- –∑–∞–¥–µ—Ä–∂–∫–∞ –º–µ–∂–¥—É —Å–æ–æ–±—â–µ–Ω–∏—è–º–∏
            end
            
            -- –ü–æ—Å–ª–µ 5 —Å–æ–æ–±—â–µ–Ω–∏–π —Å—Ä–∞–∑—É –ø–µ—Ä–µ–∑–∞—Ö–æ–¥–∏–º
            task.wait(1)
            hopServer() -- –ø–µ—Ä–µ—Ö–æ–¥ –Ω–∞ –Ω–æ–≤—ã–π —Å–µ—Ä–≤–µ—Ä
        end)
        
        if not success then
            warn("–û—à–∏–±–∫–∞ –≤ –æ—Å–Ω–æ–≤–Ω–æ–º —Ü–∏–∫–ª–µ: " .. tostring(errorMsg))
            task.wait(3) -- –∂–¥–µ–º –ø–µ—Ä–µ–¥ –ø–æ–≤—Ç–æ—Ä–Ω–æ–π –ø–æ–ø—ã—Ç–∫–æ–π
            TeleportService:Teleport(placeId) -- –ø–µ—Ä–µ–∑–∞—Ö–æ–¥–∏–º –ø—Ä–∏ –æ—à–∏–±–∫–µ
        end
    end
end

-- –ê–≤—Ç–æ–∑–∞–ø—É—Å–∫ —Å–∫—Ä–∏–ø—Ç–∞
setupAutoRejoin()

-- –ó–∞–ø—É—Å–∫–∞–µ–º –æ—Å–Ω–æ–≤–Ω–æ–π —Ü–∏–∫–ª —Å –Ω–µ–±–æ–ª—å—à–æ–π –∑–∞–¥–µ—Ä–∂–∫–æ–π –¥–ª—è –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏
task.wait(2)
mainLoop()
